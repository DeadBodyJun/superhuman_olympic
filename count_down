using UnityEngine;
using UnityEngine.Networking;

public class MusicPlayer : MonoBehaviour
{
    public string musicFileName = "count down.mp3";
    private string musicUrl;
    private AudioSource audioSource;
    private bool isMusicLoaded = false;

    void Start()
    {
        audioSource = GetComponent<AudioSource>();
        musicUrl = Path.Combine(Application.streamingAssetsPath, musicFileName);
        StartCoroutine(DownloadMusic());
    }

    void Update()
    {
        if (isMusicLoaded && Input.GetKeyDown(KeyCode.Return))
        {
            if (!audioSource.isPlaying)
            {
                audioSource.Play();
            }
            else
            {
                audioSource.Pause();
            }
        }
    }

    IEnumerator DownloadMusic()
    {
        using (UnityWebRequest www = UnityWebRequestMultimedia.GetAudioClip(musicUrl, AudioType.MPEG))
        {
            yield return www.SendWebRequest();

            if (www.result == UnityWebRequest.Result.ConnectionError || www.result == UnityWebRequest.Result.ProtocolError)
            {
                Debug.Log("Error while downloading music: " + www.error);
            }
            else
            {
                AudioClip musicClip = DownloadHandlerAudioClip.GetContent(www);
                audioSource.clip = musicClip;
                isMusicLoaded = true;
            }
        }
    }
}
